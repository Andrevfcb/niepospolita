{"version":3,"sources":["Components/Body/Order.js"],"names":["Order","useHttpClient","isLoading","error","sendRequest","clearError","useState","deliveryPrice","setDeliveryPrice","timepickerValue","setTimepickerValue","minTime","setMinTime","maxTime","setMaxTime","isToLateToOrder","setIsToLateToOrder","paymentOffline","setPaymentOffline","deliveryHours","setDeliveryHours","stripe","useStripe","history","useHistory","useDate","today","dayId","currentHour","currentMinute","useContext","CartContext","cartItems","total","bonusItem","useEffect","window","scrollTo","getDeliveryPrice","a","process","responseData","delivery_price","value","getDeliveryHours","time","minOrderTime","maxOrderTime","currentDay","find","_id","startHour","start","hour","startMinute","minute","endHour","end","endMinute","toString","Date","useForm","street","isValid","local","apartament","zipCode","city","email","phoneNumber","message","formState","inputHandler","formSubmitHandler","event","preventDefault","customer_items","map","i","quantity","name","price","line_items","price_data","currency","unit_amount","product_data","description","push","item","address","inputs","target","id","JSON","stringify","customer_email","deliveryHour","phone","productName","option","sessionId","redirectToCheckout","paymentMethod","delivery_info","totalAmount","bonusItemName","customer_phoneNumber","customer_address","location","reload","Fragment","asOverlay","onClear","className","element","type","label","validators","VALIDATOR_REQUIRE","errorText","onInput","initialValid","style","position","VALIDATOR_EMAIL","fontWeight","marginBottom","minHeight","placeholder","format","step","min","max","onChange","e","hours","minutes","getHours","getMinutes","disabled","onClick","prevPayment","isClicked","margin","payment","color"],"mappings":"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","file":"static/js/6.9d783a71.chunk.js","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport \"./Order.css\"\r\nimport Button from '../FormElements/Button'\r\nimport LoadingSpinner from \"../UIElements/LoadingSpinner\"\r\nimport { useHttpClient } from '../hooks/http-hook';\r\nimport ErrorModal from \"../UIElements/ErrorModal\";\r\nimport { CartContext } from '../../context/cart-context';\r\nimport Card from '../UIElements/Card';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { useStripe } from '@stripe/react-stripe-js'\r\nimport { TimePickerComponent } from '@syncfusion/ej2-react-calendars'\r\nimport { useDate } from '../hooks/date-hook';\r\n\r\nimport {\r\n    VALIDATOR_REQUIRE,\r\n    VALIDATOR_EMAIL\r\n  } from '../util/validators';\r\n  import Input from '../FormElements/Input';\r\n\r\nimport { useForm } from \"../hooks/form-hook\"\r\n\r\nconst Order = () => {\r\n    \r\n\r\n    const { isLoading, error, sendRequest, clearError } = useHttpClient();\r\n    \r\n    const [deliveryPrice, setDeliveryPrice] = useState(false);\r\n    const [timepickerValue, setTimepickerValue] = useState('nie określono');\r\n    const [minTime, setMinTime] = useState();\r\n    const [maxTime, setMaxTime] = useState();\r\n    const [isToLateToOrder, setIsToLateToOrder] = useState(false);\r\n    const [paymentOffline, setPaymentOffline] = useState(false);\r\n\r\n    const [deliveryHours, setDeliveryHours] = useState(false);\r\n    const stripe = useStripe();\r\n    let history = useHistory();\r\n    \r\n    const { today, dayId, currentHour, currentMinute } = useDate();\r\n    const { cartItems, total, bonusItem } = useContext(CartContext);\r\n\r\n    useEffect(() => {\r\n        window.scrollTo(0, 0)\r\n            const getDeliveryPrice = async () => {\r\n                \r\n                try {\r\n                    const responseData = await sendRequest(\r\n                        `${process.env.REACT_APP_BACKEND_URL}/api/delivery/${process.env.REACT_APP_DELIVERY_PRICE_ID}`\r\n                      );\r\n                      setDeliveryPrice(responseData.delivery_price.value);\r\n                } catch (err) {}\r\n            }\r\n            const getDeliveryHours = async () => {\r\n                \r\n                try {\r\n                    const responseData = await sendRequest(\r\n                    `${process.env.REACT_APP_BACKEND_URL}/api/time/`\r\n                  );\r\n                \r\n                  setDeliveryHours(responseData.time)\r\n                } catch (err) {}\r\n            } \r\n            getDeliveryPrice()\r\n            getDeliveryHours()\r\n    }, [sendRequest])\r\n\r\n    useEffect(() => {\r\n        let minOrderTime\r\n        let maxOrderTime\r\n        if(deliveryHours && today && dayId && currentHour && currentMinute) {\r\n            const currentDay = deliveryHours.find(time => time._id === dayId)\r\n            const startHour = currentDay.time.start.hour\r\n            let startMinute = currentDay.time.start.minute\r\n            const endHour = currentDay.time.end.hour\r\n            let endMinute = currentDay.time.end.minute\r\n\r\n            if (currentDay.time.start.minute < 10) {\r\n                startMinute = currentDay.time.start.minute + '0'\r\n            } else {\r\n                startMinute = currentDay.time.start.minute\r\n            }\r\n\r\n            if (currentDay.time.end.minute < 10) {\r\n                endMinute = currentDay.time.end.minute + '0'\r\n            } else {\r\n                endMinute = currentDay.time.end.minute\r\n            }\r\n            \r\n            maxOrderTime = (endHour + ':' + endMinute).toString()\r\n            \r\n            \r\n            if(currentHour > startHour) {\r\n                if(currentMinute > 45) {\r\n                    minOrderTime = (currentHour + 2 + ':00').toString()\r\n                } else if (currentMinute > 30) {\r\n                    minOrderTime = (currentHour + 1 + ':45').toString()\r\n                } else if (currentMinute > 15) {\r\n                    minOrderTime = (currentHour + 1 + ':30').toString()\r\n                } else {\r\n                    minOrderTime = (currentHour + 1 + ':15').toString()\r\n                }\r\n                \r\n            } else if (currentHour === startHour && currentMinute > startMinute) {\r\n                if(currentMinute > 45) {\r\n                    minOrderTime = (currentHour + 2 + ':00').toString()\r\n                } else if (currentMinute > 30) {\r\n                    minOrderTime = (currentHour + 1 + ':45').toString()\r\n                } else if (currentMinute > 15) {\r\n                    minOrderTime = (currentHour + 1 + ':30').toString()\r\n                } else {\r\n                    minOrderTime = (currentHour + 1 + ':15').toString()\r\n                }\r\n            } else minOrderTime = (startHour + 1 + ':' + startMinute).toString()\r\n\r\n            if(currentHour >= endHour || (currentHour === (endHour - 1) && (currentMinute > endMinute )) ) {\r\n                setIsToLateToOrder(true)\r\n            }\r\n        }\r\n            if(minOrderTime && maxOrderTime) {\r\n                setMinTime(new Date(`8/3/2017 ${minOrderTime}`))\r\n                setMaxTime(new Date(`8/3/2017 ${maxOrderTime}`))\r\n            }\r\n    }, [deliveryHours, today, dayId, currentHour, currentMinute])\r\n\r\n    const [formState, inputHandler] = useForm(\r\n        {\r\n            street: {\r\n                value: '',\r\n                isValid: false\r\n        },\r\n            local: {\r\n                value: '',\r\n                isValid: false\r\n        },\r\n            apartament: {\r\n                value: null,\r\n                isValid: true\r\n        },\r\n            zipCode: {\r\n                value: '',\r\n                isValid: false\r\n        },\r\n            city: {\r\n                value: '',\r\n                isValid: false\r\n        },\r\n            email: {\r\n                value: '',\r\n                isValid: false\r\n        },\r\n            phoneNumber: {\r\n                value: '',\r\n                isValid: false\r\n        },\r\n        message: {\r\n            value: null,\r\n            isValid: true\r\n        },\r\n        },\r\n        false\r\n      );\r\n\r\n    const formSubmitHandler = async event => {\r\n        event.preventDefault();\r\n        \r\n        let customer_items = cartItems.map(i => {\r\n            return {\r\n                quantity: i.quantity,\r\n                name: i.name,\r\n                price: i.price\r\n            }\r\n        })\r\n        let line_items\r\n        if (cartItems && deliveryPrice) {\r\n            line_items = cartItems.map(i => {\r\n                return {\r\n                    quantity: i.quantity,\r\n                    price_data: {\r\n                        currency: \"pln\",\r\n                        unit_amount: i.price * 100,\r\n                        product_data: {\r\n                            name: i.name,\r\n                            description: i.description\r\n                        }\r\n                    }  \r\n                }\r\n            })\r\n    \r\n            const delivery_price = {\r\n                quantity: 1,\r\n                price_data: {\r\n                    currency: \"pln\",\r\n                    unit_amount: deliveryPrice * 100,\r\n                    product_data: {\r\n                        name: 'opłata za dowóz'\r\n                    }\r\n                }  \r\n            }\r\n            \r\n            if (total >= 80 && bonusItem) {\r\n                line_items.push({\r\n                    quantity: 1,\r\n                    price_data: {\r\n                        currency: \"pln\",\r\n                        unit_amount: 0 * 100,\r\n                        product_data: {\r\n                            name: bonusItem.item + \" gratis\"\r\n                        }}})\r\n            } else if (total <= 60) {\r\n                line_items.push(delivery_price)\r\n            }\r\n        }\r\n        \r\n        let address = {\r\n            street: formState.inputs.street.value,\r\n            local: formState.inputs.local.value,\r\n            zipCode: formState.inputs.zipCode.value,\r\n            city: formState.inputs.city.value\r\n        }\r\n        if (!!formState.inputs.apartament.value) {\r\n            address = {\r\n                ...address,\r\n                apartament: formState.inputs.apartament.value\r\n            }\r\n        } else {\r\n            address = {\r\n                ...address,\r\n                apartament: false\r\n            }\r\n        }\r\n        let message\r\n        if (!!formState.inputs.message.value) {\r\n            message = formState.inputs.message.value\r\n        } else {\r\n            message = 'brak'\r\n        }\r\n        if (event.target.id === \"payment-online\" && !isToLateToOrder) {\r\n            try {\r\n                const responseData = await sendRequest(\r\n                    `${process.env.REACT_APP_BACKEND_URL}/api/checkout/`,\r\n                    'POST',\r\n                    JSON.stringify({\r\n                        line_items,\r\n                        customer_email: formState.inputs.email.value,\r\n                        message,\r\n                        deliveryHour: timepickerValue.toString(),\r\n                        phone: formState.inputs.phoneNumber.value,\r\n                        address,\r\n                        productName: '',\r\n                        option: 'order'\r\n                    }),\r\n                    {\r\n                      'Content-Type': 'application/json'\r\n                    }\r\n                );\r\n                const { sessionId } = responseData\r\n                await stripe.redirectToCheckout({\r\n                    sessionId\r\n                })\r\n            } catch (err) {}\r\n        } else if (event.target.id === \"payment-offline\" && !isToLateToOrder) {\r\n\r\n            let delivery_info\r\n            let totalAmount\r\n            const paymentMethod = event.target.name\r\n            if (total && deliveryPrice && total <= 60 ) {\r\n                delivery_info = deliveryPrice + \"zł\"\r\n                totalAmount = total + deliveryPrice\r\n            } else {\r\n                delivery_info = \"dostawa gratis\"\r\n                totalAmount = total\r\n            }\r\n            let bonusItemName = 'brak'\r\n            if(bonusItem && total > 80 ) {\r\n                bonusItemName = bonusItem.item\r\n            }\r\n            \r\n            try { \r\n                await sendRequest(\r\n                    `${process.env.REACT_APP_BACKEND_URL}/api/mail/`,\r\n                    'POST',\r\n                    JSON.stringify({\r\n                        customer_email: formState.inputs.email.value,\r\n                        customer_phoneNumber: formState.inputs.phoneNumber.value,\r\n                        customer_address: address,\r\n                        customer_items,\r\n                        total: totalAmount,\r\n                        delivery_info,\r\n                        bonusItemName,\r\n                        timepickerValue,\r\n                        paymentMethod\r\n                    }),\r\n                    {\r\n                      'Content-Type': 'application/json'\r\n                    }\r\n                );\r\n                await history.push(\"/success\")\r\n                window.location.reload()\r\n              } catch (err) {}\r\n        } \r\n      };\r\n\r\n    const handleTimeValue = (e) => {\r\n        let hours\r\n        let minutes\r\n        if (e.target.value) {\r\n            hours = e.target.value.getHours()\r\n            minutes = e.target.value.getMinutes()\r\n            if (minutes < 10) {\r\n                minutes = '0' + e.target.value.getMinutes()\r\n            }\r\n            setTimepickerValue(hours + ':' + minutes)\r\n        } else {setTimepickerValue('nie określono')}\r\n      }\r\n\r\n    const handleOfflinePayment = (e) => {\r\n        e.preventDefault();\r\n        setPaymentOffline(prevPayment => !prevPayment)\r\n    }\r\n    \r\n    return (\r\n        <React.Fragment>\r\n        {isLoading && <LoadingSpinner asOverlay />}\r\n        <ErrorModal error={error} onClear={clearError} />\r\n        <div className=\"order\">\r\n                <h1>Uzupełnij dane do zamówienia</h1>\r\n                <Card>\r\n                {!isToLateToOrder &&  \r\n                <form\r\n                >\r\n                    <div className=\"address-street\">\r\n                    <Input \r\n                    id=\"street\"\r\n                    element=\"input\"\r\n                    type=\"text\"\r\n                    label=\"Ulica\"\r\n                    validators={[VALIDATOR_REQUIRE()]}\r\n                    errorText=\"Wprowadź poprawną nazwę ulicy.\"\r\n                    onInput={inputHandler}\r\n                    />\r\n                    <Input \r\n                    id=\"local\"\r\n                    element=\"input\"\r\n                    type=\"text\"\r\n                    label=\"Nr lokalu\"\r\n                    validators={[VALIDATOR_REQUIRE()]}\r\n                    errorText=\"Podaj poprawny nr lokalu.\"\r\n                    onInput={inputHandler}\r\n                    />\r\n                    <Input \r\n                    id=\"apartament\"\r\n                    element=\"input\"\r\n                    type=\"text\"\r\n                    label=\"Nr mieszkania\"\r\n                    validators={null}\r\n                    initialValid={true}\r\n                    onInput={inputHandler}\r\n                    />\r\n                    </div>\r\n                    <div className=\"address-city\">\r\n                        <div className=\"address-city__zip\" style={{position: 'relative'}}>\r\n                            <div className=\"address-city__zip-input\">\r\n                            <Input \r\n                                id=\"zipCode\"\r\n                                element=\"input\"\r\n                                type=\"text\"\r\n                                label=\"Kod pocztowy\"\r\n                                validators={[VALIDATOR_REQUIRE()]}\r\n                                errorText={\"Podaj poprawny kod pocztowy.\"}\r\n                                onInput={inputHandler}\r\n                            />\r\n                            </div>\r\n                        </div>\r\n                    <div className=\"address-city__city\">\r\n                    <Input \r\n                    id=\"city\"\r\n                    element=\"input\"\r\n                    type=\"text\"\r\n                    label=\"Miasto\"\r\n                    validators={[VALIDATOR_REQUIRE()]}\r\n                    errorText=\"Podaj poprawną nazwę miasta.\"\r\n                    onInput={inputHandler}\r\n                    />\r\n                    </div>\r\n                    \r\n                    </div>\r\n                    <Input \r\n                    id=\"email\"\r\n                    element=\"input\"\r\n                    type=\"email\"\r\n                    label=\"Email\"\r\n                    validators={[VALIDATOR_REQUIRE(), VALIDATOR_EMAIL]}\r\n                    errorText=\"Podaj poprawny email.\"\r\n                    onInput={inputHandler}\r\n                    />\r\n                    <Input \r\n                    id=\"phoneNumber\"\r\n                    element=\"input\"\r\n                    type=\"text\"\r\n                    label=\"Numer telefonu\"\r\n                    validators={[VALIDATOR_REQUIRE()]}\r\n                    errorText=\"Podaj nr telefonu.\"\r\n                    onInput={inputHandler}\r\n                    />\r\n                    <Input \r\n                    id=\"message\"\r\n                    element=\"textarea\"\r\n                    type=\"text\"\r\n                    label=\"Komentarz do dostawcy\"\r\n                    validators={null}\r\n                    initialValid={true}\r\n                    onInput={inputHandler}\r\n                    />\r\n                    <label style={{fontWeight: 'bold', marginBottom: '0.5rem', minHeight: '28px'}}>Wybierz oczekiwany czas dowozu:</label>\r\n                    <div className='timepicker'>\r\n                    <TimePickerComponent\r\n                    placeholder=\"wybierz godzinę\"\r\n                    format=\"HH:mm\"\r\n                    step={15}\r\n                    min={minTime}\r\n                    max={maxTime}\r\n                    onChange={handleTimeValue}\r\n                    ></TimePickerComponent>\r\n                    </div>\r\n                    <div>\r\n                    <Button\r\n                    disabled={!formState.isValid || isToLateToOrder}\r\n                    id=\"payment-offline\"\r\n                    onClick={handleOfflinePayment}\r\n                    isClicked={paymentOffline}\r\n                    >\r\n                    PŁATNOŚĆ PRZY ODBIORZE\r\n                    </Button>\r\n                    <Button\r\n                    disabled={!formState.isValid || isToLateToOrder || paymentOffline}\r\n                    id=\"payment-online\"\r\n                    onClick={formSubmitHandler}\r\n                    >\r\n                    PŁATNOŚĆ ONLINE\r\n                    </Button>\r\n                    </div>\r\n                    {paymentOffline && <div style={{margin: '1em'}}>\r\n                    <Button\r\n                    disabled={!formState.isValid || isToLateToOrder}\r\n                    id=\"payment-offline\"\r\n                    payment=\"karta\"\r\n                    onClick={formSubmitHandler}\r\n                    >\r\n                    PŁATNOŚĆ KARTĄ\r\n                    </Button>\r\n                    <Button\r\n                    disabled={!formState.isValid || isToLateToOrder}\r\n                    id=\"payment-offline\"\r\n                    payment=\"gotówka\"\r\n                    onClick={formSubmitHandler}\r\n                    >\r\n                    PŁATNOŚĆ GOTÓWKĄ\r\n                    </Button>\r\n                    </div>}\r\n                </form>}\r\n                {isToLateToOrder && <p style={{color: 'red'}}>Dziś już nie dowozimy, zapraszamy ponownie.</p>}\r\n                </Card>\r\n        </div>\r\n        </React.Fragment>\r\n        \r\n    )\r\n}\r\n\r\nexport default Order\r\n"],"sourceRoot":""}
(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[7],{100:function(e,t,a){},169:function(e,t,a){"use strict";a.r(t);var n=a(6),r=a.n(n),i=a(12),s=a(2),c=a(1),o=a.n(c),l=(a(100),a(16)),u=a(14),p=a(0),d=function(e){var t=e.id,a=e.name,n=e.price,r=e.image,i=e.description,s=e.specialItemCheckedId,c=e.changeClickedProductId;return Object(p.jsx)(o.a.Fragment,{children:Object(p.jsxs)("div",{className:"item-card",children:[Object(p.jsx)("div",{className:"item-card__image",children:Object(p.jsx)("img",{src:"".concat("https://niepospolita.s3.eu-central-1.amazonaws.com","/").concat(r),alt:a})}),Object(p.jsxs)("div",{className:"item-card__info",children:[Object(p.jsxs)("p",{className:" name price",children:[Object(p.jsx)("span",{style:{fontWeight:"bold"},children:a}),Object(p.jsxs)("span",{style:{fontWeight:"bold",marginLeft:"0.7em"},children:[n," z\u0142"]})]}),Object(p.jsx)("p",{className:"description",children:i}),Object(p.jsx)(u.a,{id:t,onClick:c,isClicked:t.toString()===s,children:"WYBIERZ"})]})]})})},j=a(102),b=a.n(j),m=(a(101),a(34)),h=a(26),v=a(30),O=a(31),g=a(17),f=a(21);t.default=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),a=t[0],n=t[1],o=Object(c.useState)(!1),j=Object(s.a)(o,2),x=j[0],y=j[1],w=Object(c.useState)(""),k=Object(s.a)(w,2),D=k[0],z=k[1],I=Object(c.useState)(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()+1)),N=Object(s.a)(I,2),V=N[0],S=N[1],C=Object(c.useState)(0),W=Object(s.a)(C,2),_=W[0],T=W[1],F=Object(c.useState)(!1),M=Object(s.a)(F,2),P=M[0],Y=M[1],H=Object(c.useState)([]),B=Object(s.a)(H,2),E=B[0],J=B[1],R=Object(l.a)(),Z=R.isLoading,q=R.error,L=R.sendRequest,G=R.clearError,U=Object(m.useStripe)(),A=Object(c.useRef)(),K=Object(O.a)({hour:{value:"",isValid:!1},guests:{value:"",isValid:!1},email:{value:"",isValid:!1},phone:{value:"",isValid:!1}},!1),Q=Object(s.a)(K,2),X=Q[0],$=Q[1];Object(c.useEffect)((function(){var e,t=function(){var e=Object(i.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L("".concat("https://niepospolita-restauracja.herokuapp.com","/api/items/"));case 3:t=e.sent,a=t.items.filter((function(e){return!0===e.special})),J(a),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();V&&(e=V.getDay()-1)<0&&(e=6),console.log(e);var a=function(){var t=Object(i.a)(r.a.mark((function t(){var a,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,L("".concat("https://niepospolita-restauracja.herokuapp.com","/api/reservation"));case 3:a=t.sent,y(a.reservations[0].available.value),z(a.reservations[0].available.message),n(a.reservations[0].days[e].availableHours),X.inputs.hour.isValid&&(i=a.reservations[0].days[e].availableHours.find((function(e){return e.hour===parseInt(X.inputs.hour.value)})),T(i.guests)),t.next=12;break;case 10:t.prev=10,t.t0=t.catch(0);case 12:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}();a(),t()}),[L,V,X.inputs.hour.isValid,X.inputs.hour.value]);var ee=function(e){if(e.preventDefault(),P===e.target.value)return Y(!1);Y(e.target.value),A.current.scrollIntoView({behavior:"smooth",block:"start"})},te=function(){var e=Object(i.a)(r.a.mark((function e(t){var a,n,i,s,c,o,l,u,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),E&&P&&(a=[{quantity:1,price_data:{currency:"pln",unit_amount:100*E[P].price,product_data:{name:E[P].name,description:E[P].description}}}]),n=V.getDate(),i=V.getMonth()+1,s=V.getFullYear(),c="Data: ".concat(n,"/").concat(i,"/").concat(s," - Godzina: ").concat(X.inputs.hour.value,":00 - liczba os\xf3b: ").concat(X.inputs.guests.value),o={street:"",local:"",zipCode:"",city:"",message:c},l=E[P].name,e.prev=8,e.next=11,L("".concat("https://niepospolita-restauracja.herokuapp.com","/api/checkout/"),"POST",JSON.stringify({line_items:a,customer_email:X.inputs.email.value,message:c,deliveryHour:"",phone:X.inputs.phone.value,address:o,productName:l,option:"reservation"}),{"Content-Type":"application/json"});case 11:return u=e.sent,p=u.sessionId,e.next=15,U.redirectToCheckout({sessionId:p});case 15:e.next=19;break;case 17:e.prev=17,e.t0=e.catch(8);case 19:case"end":return e.stop()}}),e,null,[[8,17]])})));return function(t){return e.apply(this,arguments)}}(),ae=a.map((function(e){return Object(p.jsxs)("option",{value:e.hour,children:[e.hour,":00"]})}));return Object(p.jsxs)("div",{className:"special",children:[Object(p.jsx)(f.a,{error:q,onClear:G}),Z&&Object(p.jsx)(g.a,{asOverlay:!0}),x&&Object(p.jsxs)("div",{children:[E.length>0&&Object(p.jsxs)("div",{className:"special-items",children:[Object(p.jsx)("h1",{children:"Wybierz produkt i zarezerwuj stolik"}),function(){var e;return E.length>0&&(e=E.sort((function(e,t){return e.name>t.name?1:-1})).map((function(e,t){return Object(p.jsx)(d,{id:t,name:e.name,price:e.price,description:e.description,image:e.image,changeClickedProductId:ee,specialItemCheckedId:P},t)}))),e}()]}),Object(p.jsx)("div",{ref:A}),P&&Object(p.jsxs)("form",{onSubmit:te,className:"special-reservation",children:[Object(p.jsx)("h2",{style:{margin:"0"},children:"Uzupe\u0142nij dane:"}),Object(p.jsxs)("p",{style:{margin:"0.5em 0 1em 0"},children:["Wybrano: ",P&&E[P].name]}),Object(p.jsx)("label",{style:{fontWeight:"bold",marginBottom:"0.5em",minHeight:"28px",display:"block"},children:"Wybierz dat\u0119:"}),Object(p.jsx)(b.a,{id:"date",selected:V,onChange:function(e){S(e),X.inputs.hour.value="",X.inputs.hour.isValid=!1,X.inputs.guests.value="",X.inputs.guests.isValid=!1,T(0)},dateFormat:"dd/MM/yyyy",minDate:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()+1),maxDate:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()+10)}),Object(p.jsx)(h.a,{id:"hour",element:"select",name:"select",label:"Wybierz godzin\u0119:",validators:[Object(v.d)()],errorText:"Prosz\u0119 wybra\u0107 godzin\u0119.",onInput:$,options:ae}),Object(p.jsx)(h.a,{id:"guests",element:"input",type:"number",label:"Wybierz liczb\u0119 os\xf3b: \n                ".concat(_>0&&X.inputs.hour.isValid?"(na godzin\u0119 ".concat(X.inputs.hour.value,":00 maksymalna liczba os\xf3b - ").concat(_,")"):""),validators:[Object(v.c)(0),Object(v.b)(_)],errorText:"Nieprawid\u0142owa liczba os\xf3b",onInput:$,options:ae}),Object(p.jsx)(h.a,{id:"email",element:"input",type:"email",label:"Podaj email:",validators:[Object(v.d)()],errorText:"Nieprawid\u0142owy email.",onInput:$}),Object(p.jsx)(h.a,{id:"phone",element:"input",type:"text",label:"Podaj nr telefonu:",validators:[Object(v.d)()],errorText:"Nieprawid\u0142owy nr telefonu.",onInput:$}),Object(p.jsx)(u.a,{type:"submit",disabled:V&&(!X.isValid||!X.inputs.hour.isValid||!X.inputs.guests.isValid),children:"Zarezerwuj i Zap\u0142a\u0107"})]})]}),!x&&Object(p.jsx)("div",{children:Object(p.jsx)("h2",{style:{marginTop:"5em"},children:D||"Brak mo\u017cliwo\u015bci rezerwacji"})})]})}}}]);
//# sourceMappingURL=7.a0e3f83c.chunk.js.map
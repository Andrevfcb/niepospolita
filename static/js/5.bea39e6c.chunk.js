(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[5],{163:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a(6),i=a.n(r),c=a(12),s=a(3),o=a(1),u=a.n(o),l=(a(99),a(14)),p=a(18),d=a(17),m=a(21),j=a(23),b=a(33),v=a(4),O=a(35),f=a(167),h=a(34),y=a(30),x=a(26),k=a(31),w=a(0);t.default=function(){var e=Object(d.a)(),t=e.isLoading,a=e.error,r=e.sendRequest,g=e.clearError,z=Object(o.useState)(!1),_=Object(s.a)(z,2),N=_[0],S=_[1],T=Object(o.useState)("nie okre\u015blono"),C=Object(s.a)(T,2),I=C[0],V=C[1],P=Object(o.useState)(),q=Object(s.a)(P,2),H=q[0],D=q[1],E=Object(o.useState)(),W=Object(s.a)(E,2),A=W[0],F=W[1],M=Object(o.useState)(!1),B=Object(s.a)(M,2),J=B[0],K=B[1],R=Object(o.useState)(!1),Z=Object(s.a)(R,2),L=Z[0],U=Z[1],G=Object(o.useState)(""),Y=Object(s.a)(G,2),Q=Y[0],X=Y[1],$=Object(o.useState)(!1),ee=Object(s.a)($,2),te=ee[0],ae=ee[1],ne=Object(o.useState)(!1),re=Object(s.a)(ne,2),ie=re[0],ce=re[1],se=Object(o.useState)(!1),oe=Object(s.a)(se,2),ue=oe[0],le=oe[1],pe=Object(o.useState)(!1),de=Object(s.a)(pe,2),me=de[0],je=de[1],be=Object(o.useState)(!1),ve=Object(s.a)(be,2),Oe=ve[0],fe=ve[1],he=Object(O.useStripe)(),ye=Object(v.g)(),xe=Object(h.a)(),ke=xe.today,we=xe.dayId,ge=xe.currentHour,ze=xe.currentMinute,_e=Object(o.useContext)(j.a),Ne=_e.cartItems,Se=_e.total,Te=_e.bonusItem,Ce=_e.tip;Object(o.useEffect)((function(){window.scrollTo(0,0);var e=function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r("".concat("https://niepospolita-restauracja.herokuapp.com","/api/delivery/").concat("617bc3415add00f3c5d37619"));case 3:t=e.sent,S(t.delivery_price.value),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r("".concat("https://niepospolita-restauracja.herokuapp.com","/api/time/"));case 3:t=e.sent,fe(t.time),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),a=function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r("".concat("https://niepospolita-restauracja.herokuapp.com","/api/bonus-items/").concat("6183e735434fe163aa0696fa"));case 3:t=e.sent,le(t.bonus_items_price.value),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r("".concat("https://niepospolita-restauracja.herokuapp.com","/api/bonus-delivery/").concat("6183e76c434fe163aa0696ff"));case 3:t=e.sent,ce(t.bonus_delivery_price.value),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r("".concat("https://niepospolita-restauracja.herokuapp.com","/api/deliverytime/").concat("6183c6c50e63c1ac6af40a7e"));case 3:t=e.sent,je(t.deliveryTime.time),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();s(),e(),t(),a(),n()}),[r]),Object(o.useEffect)((function(){var e,t;if(Oe&&ke&&we&&ge&&ze){var a=Oe.find((function(e){return e._id===we})),n=a.time.start.hour,r=a.time.start.minute,i=a.time.end.hour,c=a.time.end.minute;if(r=a.time.start.minute<10?a.time.start.minute+"0":a.time.start.minute,t=(i+":"+(c=a.time.end.minute<10?a.time.end.minute+"0":a.time.end.minute)).toString(),e=ge>n||ge===n&&ze>r?ze>45?(ge+2+":00").toString():ze>30?(ge+1+":45").toString():ze>15?(ge+1+":30").toString():(ge+1+":15").toString():(n+1+":"+r).toString(),(ge>=i||ge===i-1&&ze>c)&&K(!0),(ge<n||ge===n&&ze<r)&&U(!0),Oe&&ke&&we){var s="".concat(n<10?"0"+n:n,":").concat(r);X(s)}}e&&t&&(D(new Date("8/3/2017 ".concat(e))),F(new Date("8/3/2017 ".concat(t))))}),[Oe,ke,we,ge,ze]);var Ie=Object(k.a)({street:{value:"",isValid:!1},local:{value:"",isValid:!1},apartament:{value:null,isValid:!0},zipCode:{value:"",isValid:!1},city:{value:"",isValid:!1},email:{value:"",isValid:!1},phoneNumber:{value:"",isValid:!1},message:{value:null,isValid:!0}},!1),Ve=Object(s.a)(Ie,2),Pe=Ve[0],qe=Ve[1],He=function(){var e=Object(c.a)(i.a.mark((function e(t){var a,c,s,o,u,l,p,d,m,j,b,v,O;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=Ne.map((function(e){return{quantity:e.quantity,name:e.name,price:e.price}})),Ne&&N&&(c=Ne.map((function(e){return{quantity:e.quantity,price_data:{currency:"pln",unit_amount:100*e.price,product_data:{name:e.name,description:e.description}}}})),s={quantity:1,price_data:{currency:"pln",unit_amount:100*N,product_data:{name:"op\u0142ata za dow\xf3z"}}},Se<=ie&&c.push(s),Se>=ue&&Te&&c.push({quantity:1,price_data:{currency:"pln",unit_amount:0,product_data:{name:Te.item+" gratis"}}}),Ce&&(o=parseFloat((100*Ce.price).toFixed(2)),c.push({quantity:1,price_data:{currency:"pln",unit_amount:o,product_data:{name:Ce.item}}}))),u={street:Pe.inputs.street.value,local:Pe.inputs.local.value,zipCode:Pe.inputs.zipCode.value,city:Pe.inputs.city.value},u=Pe.inputs.apartament.value?Object(n.a)(Object(n.a)({},u),{},{apartament:"/ ".concat(Pe.inputs.apartament.value)}):Object(n.a)(Object(n.a)({},u),{},{apartament:!1}),l=Pe.inputs.message.value?Pe.inputs.message.value:"brak","payment-online"!==t.target.id||J){e.next=20;break}return e.prev=7,e.next=10,r("".concat("https://niepospolita-restauracja.herokuapp.com","/api/checkout/"),"POST",JSON.stringify({line_items:c,customer_email:Pe.inputs.email.value,message:l,deliveryHour:I.toString(),phone:Pe.inputs.phoneNumber.value,address:u,productName:"",startHour:Q,deliveryTime:me,option:"order"}),{"Content-Type":"application/json"});case 10:return p=e.sent,d=p.sessionId,e.next=14,he.redirectToCheckout({sessionId:d});case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(7);case 18:e.next=37;break;case 20:if("payment-offline"!==t.target.id||J){e.next=37;break}return b=t.target.name,Se&&N&&Se<=ie?(m=N+"z\u0142",j=Se+N):(m="dostawa gratis",j=Se),v="brak",Te&&Se>ue&&(v=Te.item),O="brak",Ce&&(O=Ce.price.toFixed(2),j=(j+Ce.price).toFixed(2)),e.prev=27,e.next=30,r("".concat("https://niepospolita-restauracja.herokuapp.com","/api/mail/"),"POST",JSON.stringify({customer_email:Pe.inputs.email.value,customer_phoneNumber:Pe.inputs.phoneNumber.value,customer_address:u,customer_items:a,message:l,total:j,delivery_info:m,bonusItemName:v,tip:O,timepickerValue:I,paymentMethod:b,startHour:Q,deliveryTime:me,option:"order"}),{"Content-Type":"application/json"});case 30:return e.next=32,ye.push("/success");case 32:window.location.reload(),e.next=37;break;case 35:e.prev=35,e.t1=e.catch(27);case 37:case"end":return e.stop()}}),e,null,[[7,16],[27,35]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)(u.a.Fragment,{children:[t&&Object(w.jsx)(p.a,{asOverlay:!0}),Object(w.jsx)(m.a,{error:a,onClear:g}),Object(w.jsxs)("div",{className:"order",children:[Object(w.jsx)("h1",{children:"Uzupe\u0142nij dane do zam\xf3wienia"}),L&&Object(w.jsxs)("div",{children:[Object(w.jsxs)("p",{style:{color:"red",marginBottom:"1em",fontWeight:"bold"},children:["* Zam\xf3wienia zostan\u0105 zrealizowane od godziny ",Q]}),Object(w.jsxs)("p",{style:{color:"red",marginBottom:"1em",fontWeight:"bold"},children:["* Czas dowozu ",me," min."]})]}),Object(w.jsxs)(b.a,{children:[!J&&Object(w.jsxs)("form",{children:[Object(w.jsxs)("div",{className:"address-street",children:[Object(w.jsx)(x.a,{id:"street",element:"input",type:"text",label:"Ulica",validators:[Object(y.c)()],errorText:"Wprowad\u017a poprawn\u0105 nazw\u0119 ulicy.",onInput:qe}),Object(w.jsx)(x.a,{id:"local",element:"input",type:"text",label:"Nr lokalu",validators:[Object(y.c)()],errorText:"Podaj poprawny nr lokalu.",onInput:qe}),Object(w.jsx)(x.a,{id:"apartament",element:"input",type:"text",label:"Nr mieszkania",validators:null,initialValid:!0,onInput:qe})]}),Object(w.jsxs)("div",{className:"address-city",children:[Object(w.jsx)("div",{className:"address-city__zip",style:{position:"relative"},children:Object(w.jsx)("div",{className:"address-city__zip-input",children:Object(w.jsx)(x.a,{id:"zipCode",element:"input",type:"text",label:"Kod pocztowy",validators:[Object(y.c)()],errorText:"Podaj poprawny kod pocztowy.",onInput:qe})})}),Object(w.jsx)("div",{className:"address-city__city",children:Object(w.jsx)(x.a,{id:"city",element:"input",type:"text",label:"Miasto",validators:[Object(y.c)()],errorText:"Podaj poprawn\u0105 nazw\u0119 miasta.",onInput:qe})})]}),Object(w.jsx)(x.a,{id:"email",element:"input",type:"email",label:"Email",validators:[Object(y.c)(),y.a],errorText:"Podaj poprawny email.",onInput:qe}),Object(w.jsx)(x.a,{id:"phoneNumber",element:"input",type:"text",label:"Numer telefonu",validators:[Object(y.c)()],errorText:"Podaj nr telefonu.",onInput:qe}),Object(w.jsx)(x.a,{id:"message",element:"textarea",type:"text",label:"Komentarz do dostawcy",validators:null,initialValid:!0,onInput:qe}),Object(w.jsx)("label",{style:{fontWeight:"bold",marginBottom:"0.5rem",minHeight:"28px"},children:"Wybierz oczekiwany czas dowozu:"}),Object(w.jsx)("div",{className:"timepicker",children:Object(w.jsx)(f.a,{placeholder:"wybierz godzin\u0119",format:"HH:mm",step:15,min:H,max:A,onChange:function(e){var t,a;e.target.value?(t=e.target.value.getHours(),(a=e.target.value.getMinutes())<10&&(a="0"+e.target.value.getMinutes()),V(t+":"+a)):V("nie okre\u015blono")}})}),Object(w.jsxs)("div",{children:[Object(w.jsx)(l.a,{disabled:!Pe.isValid||J,id:"payment-offline",onClick:function(e){e.preventDefault(),ae((function(e){return!e}))},isClicked:te,children:"P\u0141ATNO\u015a\u0106 PRZY ODBIORZE"}),Object(w.jsx)(l.a,{disabled:!Pe.isValid||J||te,id:"payment-online",onClick:He,children:"P\u0141ATNO\u015a\u0106 ONLINE"})]}),te&&Object(w.jsxs)("div",{style:{margin:"1em"},children:[Object(w.jsx)(l.a,{disabled:!Pe.isValid||J,id:"payment-offline",payment:"karta",onClick:He,children:"P\u0141ATNO\u015a\u0106 KART\u0104"}),Object(w.jsx)(l.a,{disabled:!Pe.isValid||J,id:"payment-offline",payment:"got\xf3wka",onClick:He,children:"P\u0141ATNO\u015a\u0106 GOT\xd3WK\u0104"})]})]}),J&&Object(w.jsx)("p",{style:{color:"red"},children:"Dzi\u015b ju\u017c nie dowozimy, zapraszamy ponownie."})]})]})]})}},99:function(e,t,a){}}]);
//# sourceMappingURL=5.bea39e6c.chunk.js.map